/sp.specify

Build a content personalization system that adapts textbook chapters based on each user's background and experience level. At the start of every chapter, logged-in users should see a "Personalize Content" button. When clicked, the system should use the user's profile information (software/hardware background, beginner/intermediate/advanced level, robotics experience) to dynamically rewrite the chapter content to match their needs.

For software engineers, emphasize code examples, API usage, and software architecture. For hardware engineers, emphasize physical components, circuits, wiring diagrams, and hardware specifications. For beginners, add more context, define technical terms, and provide step-by-step guidance. For advanced users, be more concise, skip basics, and focus on best practices and advanced patterns.

The personalization should feel intelligent and helpful, not just surface-level changes. Use GPT-4 to truly adapt the writing style, depth of explanations, and types of examples. If someone is a software engineer with advanced programming skills but no robotics experience, they should get detailed robotics concepts explained but can skip basic Python tutorials.

Users should be able to toggle between original and personalized versions easily. There should be a clear indicator showing "Personalized for: Software Engineer (Advanced)" so users understand the content has been adapted. The system should cache personalized versions so users don't have to wait every time they revisit a chapter.

Personalization should work seamlessly across all chapters and update automatically if users change their profile information. The system should also remember which personalization settings users prefer (do they always want personalized content, or do they prefer to manually trigger it?).


/sp.plan

Use the following technical architecture:

Backend API:
- POST /api/personalize/chapter: Generate personalized content
- Input: chapter_url, user_profile (background, experience levels)
- Process: Read original markdown, send to GPT-4 with personalization prompt, return adapted markdown
- Caching: Store personalized versions in Neon Postgres with TTL (7 days)

GPT-4 Personalization Prompt Template:You are an educational content adapter. Rewrite this robotics textbook chapter to match the reader's profile.
User Profile:

Background: {software_engineer | hardware_engineer | student | other}
Programming Level: {beginner | intermediate | advanced}
Robotics Experience: {none | hobby | professional}
Familiar with: {Python, C++, ROS, Linux, etc.}
Learning Goals: {user's stated goals}

Original Content:
{original_markdown_content}
Adaptation Instructions:

For software engineers: Emphasize code structure, APIs, software patterns, abstract concepts
For hardware engineers: Emphasize physical components, specifications, wiring, practical implementation
For beginners: Add definitions, context, step-by-step guidance, "What this means is..."
For advanced: Be concise, skip basics, focus on best practices, advanced topics, edge cases
Maintain all section headers exactly
Keep the same overall structure
Preserve all code blocks (but may adjust comments)
Return ONLY markdown (no preamble, no explanations)

Rewrite the chapter now.

Frontend Components:
- PersonalizeButton: Button at top of each chapter
- PersonalizationIndicator: Badge showing "Personalized for: [Profile]"
- ContentToggle: Switch between original and personalized
- SettingsModal: Preference for auto-personalize

Storage Strategy:
- Personalized content cached in Neon Postgres
- Key: user_id + chapter_url + profile_hash
- TTL: 7 days (or until profile changes)
- Clear cache when user updates profile

User Flow:
1. User navigates to chapter page
2. If logged in, see "Personalize Content" button at top
3. Click button â†’ loading indicator (5-10 seconds)
4. Content replaces original with personalized version
5. Badge appears: "Personalized for: Software Engineer (Advanced)"
6. Toggle button to switch back to original
7. Personalized version cached for future visits

Integration with Existing Code:
- Extend Docusaurus MDX rendering
- Check if personalized version exists in cache
- If exists and fresh, load from cache
- If not, show personalize button
- Store personalized markdown in state, render dynamically

Performance Optimization:
- Generate personalization asynchronously
- Show progress indicator with estimated time
- Use GPT-4 Turbo for faster responses
- Batch requests if user personalizes multiple chapters
- Preload next chapter personalization in background

Cost Management:
- Estimate: ~2000 tokens input + ~2000 tokens output per chapter
- ~$0.04 per personalization with GPT-4 Turbo
- Cache aggressively to avoid re-generation
- Limit: 5 personalizations per day per user (free tier)

Success Metrics:
- Personalization completes in <10 seconds
- Content is meaningfully different for different profiles
- Users can easily toggle between versions
- Cache hit rate >70%




/sp.tasks

Break down personalization implementation into tasks including GPT-4 prompt engineering, caching system, frontend personalize button, content rendering, and profile-based adaptation logic.






/sp.implement

Execute all personalization tasks. Start with backend personalization endpoint and caching, then create frontend button and content rendering, integrate with Docusaurus MDX, and test with different user profiles.

Use these subagents and skills:
- /subagent python-expert for personalization API
- /subagent api-architect for caching strategy
- /skill fastapi-development for API endpoint
- /subagent react-developer for personalize button UI
- /skill react-components for content rendering
- /subagent educational-content-designer to validate personalization quality

Priority order:
1. Create personalization API endpoint with GPT-4 integration
2. Implement caching in Neon Postgres
3. Build PersonalizeButton component
4. Build content rendering system (original vs personalized)
5. Add toggle functionality
6. Test with various user profiles (software/hardware, beginner/advanced)
7. Optimize for performance and cost

Test extensively with different profiles to ensure content adaptation is meaningful and helpful.

